import { getDataFromServer } from './getDataFromServer';import { syncDataToDB } from './syncDataToDB';import { getDBMetadata } from './getDBMetadata';import { updateDBControl } from './updateDBControl';import { getModelData } from './getModelData';export function start({ name, version, user_id }) {  const indexedDB = window.indexedDB ||    window.mozIndexedDB ||    window.webkitIndexedDB ||    window.msIndexedDB;  // No indexedDB, we just request all data always  if (!indexedDB) {    return new Promise((resolve, reject) => {      getDataFromServer({ user_id })      .then(({ items }) => resolve(items))      .catch(reject);    });  }  return new Promise((resolve, reject) => {    const request = indexedDB.open(name, version);    request.onsuccess = () => resolve({ instance: request.result, user_id });    request.onerror = () => reject(request.error);    request.onupgradeneeded = e => {      const instance = e.target.result;      instance.model = instance.createObjectStore('model', { keyPath: '_id' });      instance.control = instance.createObjectStore('control', { keyPath: '_id' });    };  })  .then(getDBMetadata)  .then(getDataFromServer)  .then(syncDataToDB)  .then(updateDBControl)  .then(getModelData)  .catch(console.log);}